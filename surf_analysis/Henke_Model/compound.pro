pro compound,compound_string,density,atwt,z_array,help=help;+; pro compound,compound_string,density,z_array;;	Type in a chemical formula and the density.  The routine;	then figures out the atomic weight in g/mole of "molecules";	and how many of what Z atoms you have.	The;	density isn't really needed here; it's just that if;	what you type is defined in;		(your directory) compounds.dat;		(or VMS) public_dir:[x1_lib.henke]compounds.dat;		(or AIX) /usr/local/x1_lib/henke/compounds.dat;		(or MS-DOS) \henke\compounds.dat;	then you can type;		compound,'protein',density,atwt,z_array;	and get both the density and z_array set for you.;;	Note that you can do "zshow,z_array" to check out the;	composition.;; CJJ Feb 93;-if (keyword_set(help) or (n_elements(compound_string) eq 0)) then begin	print,'compound,compound_string,density,atwt,z_array'	print,'  Looks in "compounds.dat" first. The parameter'	print,'  "atwt" is the atomic/molecular weight in g/mole.'	returnendiftabchar='	'backslash='\';if (!version.os eq 'windows') then begin;	system_compound_file='c:'+backslash+'henke'+backslash+'compounds.dat';endif else if (!version.os eq 'AIX') then begin;	system_compound_file='/usr/local/lib/xraycode/henke/compounds.dat';endif else if (!version.os eq 'vms') then begin;	system_compound_file='public_disk:[x1_lib.henke]compounds.dat';endif else if (!version.os eq 'sunos') then begin;	system_compound_file='$rocket/henke/compounds.dat';endif else if (!version.os eq 'MacOS') then begin;	system_compound_file='compounds.dat';endif else if (!version.os eq 'darwin') then begin    sdir = getenv( 'henke_model' )    if (strlen(sdir) gt 0) then sdir = sdir+'/'	system_compound_file=sdir+'compounds.dat';endif else begin;	print,'WARNING:  Unknown system!';	system_compound_file='compounds.dat';endelseon_ioerror,try_system_fileopenr,lun,'compounds.dat',/get_lungoto,got_filetry_system_file: on_ioerror,no_fileopenr,lun,system_compound_file,/get_lungoto,got_fileno_file: print,'Could not open file "compounds.dat" or "', $	system_compound_file,'".'close,lunfree_lun,lunreturngot_file: on_ioerror,nomatchinput_string=''while (not eof(lun)) do begin	readf,lun,input_string	input_string=strtrim(input_string,1)	last_char_index=strlen(input_string)-1	space_index=-1	char_index=0	test_char=strmid(input_string,char_index,1)	while ((char_index lt last_char_index) and (test_char ne ' ') and $		(test_char ne tabchar)) do begin		char_index=char_index+1		test_char=strmid(input_string,char_index,1)	endwhile	; we should have found a space or a tabchar	if ((test_char ne ' ') and (test_char ne tabchar)) then begin		message,'no white space to second word in compounds.dat'		return	endif else begin		space_index=char_index	endelse	if ((strmid(input_string,0,1) ne '!') and $		(space_index ne -1)) then begin	    firstword=strmid(input_string,0,space_index)	    if (firstword eq compound_string) then begin		last_char_index=strlen(input_string)-1		secondword=strtrim(strmid(input_string,space_index, $		    (last_char_index-space_index+1)),1)		last_char_index=strlen(secondword)-1		space_index=-1		char_index=0		test_char=strmid(secondword,char_index,1)		while ((char_index lt last_char_index) and $			(test_char ne ' ') and (test_char ne tabchar)) do begin			char_index=char_index+1			test_char=strmid(secondword,char_index,1)		endwhile		; we should have found a space or a tabchar		if ((test_char ne ' ') and (test_char ne tabchar)) then begin			message,'no white space to third word in compounds.dat'			return		endif else begin			space_index=char_index		endelse		thirdword=strmid(secondword,space_index, $			(last_char_index-space_index+1))		secondword=strtrim(strmid(secondword,0,space_index),2)		thirdword=strtrim(thirdword,2)		density=0.		reads,thirdword,density		compound_string=secondword		zcompound,compound_string,z_array		atwt=0.		zatwt,atwt,z_array		close,lun		free_lun,lun		return	    endif	endifendwhilenomatch: close,lunfree_lun,lunzcompound,compound_string,z_arrayatwt=0.zatwt,atwt,z_arrayreturnconfused:message,'got confused'close,lunfree_lun,lunreturnend